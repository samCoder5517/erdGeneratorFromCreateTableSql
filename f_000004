import{a as Pt,b as Kt}from"./chunk-E7ULZGVI.js";import{d as gt}from"./chunk-C5W7GWQ7.js";import{m as et,o as Ct}from"./chunk-BRCOMXA6.js";import{Ea as te,H as Ft,I as V,Ia as ee,K as Ut,M as Qt,N as Jt,Z as _,h as x,ha as j,j as P}from"./chunk-U32CP6J3.js";import{a as Lt,b as $t,h as D}from"./chunk-3XFQOAE3.js";function Dt(s,t,e){if(s&&s.length){let[r,a]=t,i=Math.PI/180*e,l=Math.cos(i),n=Math.sin(i);for(let c of s){let[o,h]=c;c[0]=(o-r)*l-(h-a)*n+r,c[1]=(o-r)*n+(h-a)*l+a}}}function Re(s,t){return s[0]===t[0]&&s[1]===t[1]}function Ne(s,t,e,r=1){let a=e,i=Math.max(t,.1),l=s[0]&&s[0][0]&&typeof s[0][0]=="number"?[s]:s,n=[0,0];if(a)for(let o of l)Dt(o,n,a);let c=function(o,h,f){let p=[];for(let m of o){let w=[...m];Re(w[0],w[w.length-1])||w.push([w[0][0],w[0][1]]),w.length>2&&p.push(w)}let u=[];h=Math.max(h,.1);let g=[];for(let m of p)for(let w=0;w<m.length-1;w++){let S=m[w],C=m[w+1];if(S[1]!==C[1]){let M=Math.min(S[1],C[1]);g.push({ymin:M,ymax:Math.max(S[1],C[1]),x:M===S[1]?S[0]:C[0],islope:(C[0]-S[0])/(C[1]-S[1])})}}if(g.sort((m,w)=>m.ymin<w.ymin?-1:m.ymin>w.ymin?1:m.x<w.x?-1:m.x>w.x?1:m.ymax===w.ymax?0:(m.ymax-w.ymax)/Math.abs(m.ymax-w.ymax)),!g.length)return u;let d=[],b=g[0].ymin,y=0;for(;d.length||g.length;){if(g.length){let m=-1;for(let w=0;w<g.length&&!(g[w].ymin>b);w++)m=w;g.splice(0,m+1).forEach(w=>{d.push({s:b,edge:w})})}if(d=d.filter(m=>!(m.edge.ymax<=b)),d.sort((m,w)=>m.edge.x===w.edge.x?0:(m.edge.x-w.edge.x)/Math.abs(m.edge.x-w.edge.x)),(f!==1||y%h==0)&&d.length>1)for(let m=0;m<d.length;m+=2){let w=m+1;if(w>=d.length)break;let S=d[m].edge,C=d[w].edge;u.push([[Math.round(S.x),b],[Math.round(C.x),b]])}b+=f,d.forEach(m=>{m.edge.x=m.edge.x+f*m.edge.islope}),y++}return u}(l,i,r);if(a){for(let o of l)Dt(o,n,-a);(function(o,h,f){let p=[];o.forEach(u=>p.push(...u)),Dt(p,h,f)})(c,n,-a)}return c}function ct(s,t){var e;let r=t.hachureAngle+90,a=t.hachureGap;a<0&&(a=4*t.strokeWidth),a=Math.round(Math.max(a,.1));let i=1;return t.roughness>=1&&(((e=t.randomizer)===null||e===void 0?void 0:e.next())||Math.random())>.7&&(i=a),Ne(s,a,r,i||1)}var lt=class{constructor(t){this.helper=t}fillPolygons(t,e){return this._fillPolygons(t,e)}_fillPolygons(t,e){let r=ct(t,e);return{type:"fillSketch",ops:this.renderLines(r,e)}}renderLines(t,e){let r=[];for(let a of t)r.push(...this.helper.doubleLineOps(a[0][0],a[0][1],a[1][0],a[1][1],e));return r}};function Mt(s){let t=s[0],e=s[1];return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}var Bt=class extends lt{fillPolygons(t,e){let r=e.hachureGap;r<0&&(r=4*e.strokeWidth),r=Math.max(r,.1);let a=ct(t,Object.assign({},e,{hachureGap:r})),i=Math.PI/180*e.hachureAngle,l=[],n=.5*r*Math.cos(i),c=.5*r*Math.sin(i);for(let[o,h]of a)Mt([o,h])&&l.push([[o[0]-n,o[1]+c],[...h]],[[o[0]+n,o[1]-c],[...h]]);return{type:"fillSketch",ops:this.renderLines(l,e)}}},Rt=class extends lt{fillPolygons(t,e){let r=this._fillPolygons(t,e),a=Object.assign({},e,{hachureAngle:e.hachureAngle+90}),i=this._fillPolygons(t,a);return r.ops=r.ops.concat(i.ops),r}},Nt=class{constructor(t){this.helper=t}fillPolygons(t,e){let r=ct(t,e=Object.assign({},e,{hachureAngle:0}));return this.dotsOnLines(r,e)}dotsOnLines(t,e){let r=[],a=e.hachureGap;a<0&&(a=4*e.strokeWidth),a=Math.max(a,.1);let i=e.fillWeight;i<0&&(i=e.strokeWidth/2);let l=a/4;for(let n of t){let c=Mt(n),o=c/a,h=Math.ceil(o)-1,f=c-h*a,p=(n[0][0]+n[1][0])/2-a/4,u=Math.min(n[0][1],n[1][1]);for(let g=0;g<h;g++){let d=u+f+g*a,b=p-l+2*Math.random()*l,y=d-l+2*Math.random()*l,m=this.helper.ellipse(b,y,i,i,e);r.push(...m.ops)}}return{type:"fillSketch",ops:r}}},Wt=class{constructor(t){this.helper=t}fillPolygons(t,e){let r=ct(t,e);return{type:"fillSketch",ops:this.dashedLine(r,e)}}dashedLine(t,e){let r=e.dashOffset<0?e.hachureGap<0?4*e.strokeWidth:e.hachureGap:e.dashOffset,a=e.dashGap<0?e.hachureGap<0?4*e.strokeWidth:e.hachureGap:e.dashGap,i=[];return t.forEach(l=>{let n=Mt(l),c=Math.floor(n/(r+a)),o=(n+a-c*(r+a))/2,h=l[0],f=l[1];h[0]>f[0]&&(h=l[1],f=l[0]);let p=Math.atan((f[1]-h[1])/(f[0]-h[0]));for(let u=0;u<c;u++){let g=u*(r+a),d=g+r,b=[h[0]+g*Math.cos(p)+o*Math.cos(p),h[1]+g*Math.sin(p)+o*Math.sin(p)],y=[h[0]+d*Math.cos(p)+o*Math.cos(p),h[1]+d*Math.sin(p)+o*Math.sin(p)];i.push(...this.helper.doubleLineOps(b[0],b[1],y[0],y[1],e))}}),i}},It=class{constructor(t){this.helper=t}fillPolygons(t,e){let r=e.hachureGap<0?4*e.strokeWidth:e.hachureGap,a=e.zigzagOffset<0?r:e.zigzagOffset,i=ct(t,e=Object.assign({},e,{hachureGap:r+a}));return{type:"fillSketch",ops:this.zigzagLines(i,a,e)}}zigzagLines(t,e,r){let a=[];return t.forEach(i=>{let l=Mt(i),n=Math.round(l/(2*e)),c=i[0],o=i[1];c[0]>o[0]&&(c=i[1],o=i[0]);let h=Math.atan((o[1]-c[1])/(o[0]-c[0]));for(let f=0;f<n;f++){let p=2*f*e,u=2*(f+1)*e,g=Math.sqrt(2*Math.pow(e,2)),d=[c[0]+p*Math.cos(h),c[1]+p*Math.sin(h)],b=[c[0]+u*Math.cos(h),c[1]+u*Math.sin(h)],y=[d[0]+g*Math.cos(h+Math.PI/4),d[1]+g*Math.sin(h+Math.PI/4)];a.push(...this.helper.doubleLineOps(d[0],d[1],y[0],y[1],r),...this.helper.doubleLineOps(y[0],y[1],b[0],b[1],r))}}),a}},z={},At=class{constructor(t){this.seed=t}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}},We=0,Tt=1,re=2,dt={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function _t(s,t){return s.type===t}function Gt(s){let t=[],e=function(l){let n=new Array;for(;l!=="";)if(l.match(/^([ \t\r\n,]+)/))l=l.substr(RegExp.$1.length);else if(l.match(/^([aAcChHlLmMqQsStTvVzZ])/))n[n.length]={type:We,text:RegExp.$1},l=l.substr(RegExp.$1.length);else{if(!l.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];n[n.length]={type:Tt,text:`${parseFloat(RegExp.$1)}`},l=l.substr(RegExp.$1.length)}return n[n.length]={type:re,text:""},n}(s),r="BOD",a=0,i=e[a];for(;!_t(i,re);){let l=0,n=[];if(r==="BOD"){if(i.text!=="M"&&i.text!=="m")return Gt("M0,0"+s);a++,l=dt[i.text],r=i.text}else _t(i,Tt)?l=dt[r]:(a++,l=dt[i.text],r=i.text);if(!(a+l<e.length))throw new Error("Path data ended short");for(let c=a;c<a+l;c++){let o=e[c];if(!_t(o,Tt))throw new Error("Param not a number: "+r+","+o.text);n[n.length]=+o.text}if(typeof dt[r]!="number")throw new Error("Bad segment: "+r);{let c={key:r,data:n};t.push(c),a+=l,i=e[a],r==="M"&&(r="L"),r==="m"&&(r="l")}}return t}function he(s){let t=0,e=0,r=0,a=0,i=[];for(let{key:l,data:n}of s)switch(l){case"M":i.push({key:"M",data:[...n]}),[t,e]=n,[r,a]=n;break;case"m":t+=n[0],e+=n[1],i.push({key:"M",data:[t,e]}),r=t,a=e;break;case"L":i.push({key:"L",data:[...n]}),[t,e]=n;break;case"l":t+=n[0],e+=n[1],i.push({key:"L",data:[t,e]});break;case"C":i.push({key:"C",data:[...n]}),t=n[4],e=n[5];break;case"c":{let c=n.map((o,h)=>h%2?o+e:o+t);i.push({key:"C",data:c}),t=c[4],e=c[5];break}case"Q":i.push({key:"Q",data:[...n]}),t=n[2],e=n[3];break;case"q":{let c=n.map((o,h)=>h%2?o+e:o+t);i.push({key:"Q",data:c}),t=c[2],e=c[3];break}case"A":i.push({key:"A",data:[...n]}),t=n[5],e=n[6];break;case"a":t+=n[5],e+=n[6],i.push({key:"A",data:[n[0],n[1],n[2],n[3],n[4],t,e]});break;case"H":i.push({key:"H",data:[...n]}),t=n[0];break;case"h":t+=n[0],i.push({key:"H",data:[t]});break;case"V":i.push({key:"V",data:[...n]}),e=n[0];break;case"v":e+=n[0],i.push({key:"V",data:[e]});break;case"S":i.push({key:"S",data:[...n]}),t=n[2],e=n[3];break;case"s":{let c=n.map((o,h)=>h%2?o+e:o+t);i.push({key:"S",data:c}),t=c[2],e=c[3];break}case"T":i.push({key:"T",data:[...n]}),t=n[0],e=n[1];break;case"t":t+=n[0],e+=n[1],i.push({key:"T",data:[t,e]});break;case"Z":case"z":i.push({key:"Z",data:[]}),t=r,e=a}return i}function fe(s){let t=[],e="",r=0,a=0,i=0,l=0,n=0,c=0;for(let{key:o,data:h}of s){switch(o){case"M":t.push({key:"M",data:[...h]}),[r,a]=h,[i,l]=h;break;case"C":t.push({key:"C",data:[...h]}),r=h[4],a=h[5],n=h[2],c=h[3];break;case"L":t.push({key:"L",data:[...h]}),[r,a]=h;break;case"H":r=h[0],t.push({key:"L",data:[r,a]});break;case"V":a=h[0],t.push({key:"L",data:[r,a]});break;case"S":{let f=0,p=0;e==="C"||e==="S"?(f=r+(r-n),p=a+(a-c)):(f=r,p=a),t.push({key:"C",data:[f,p,...h]}),n=h[0],c=h[1],r=h[2],a=h[3];break}case"T":{let[f,p]=h,u=0,g=0;e==="Q"||e==="T"?(u=r+(r-n),g=a+(a-c)):(u=r,g=a);let d=r+2*(u-r)/3,b=a+2*(g-a)/3,y=f+2*(u-f)/3,m=p+2*(g-p)/3;t.push({key:"C",data:[d,b,y,m,f,p]}),n=u,c=g,r=f,a=p;break}case"Q":{let[f,p,u,g]=h,d=r+2*(f-r)/3,b=a+2*(p-a)/3,y=u+2*(f-u)/3,m=g+2*(p-g)/3;t.push({key:"C",data:[d,b,y,m,u,g]}),n=f,c=p,r=u,a=g;break}case"A":{let f=Math.abs(h[0]),p=Math.abs(h[1]),u=h[2],g=h[3],d=h[4],b=h[5],y=h[6];f===0||p===0?(t.push({key:"C",data:[r,a,b,y,b,y]}),r=b,a=y):(r!==b||a!==y)&&(pe(r,a,b,y,f,p,u,g,d).forEach(function(m){t.push({key:"C",data:m})}),r=b,a=y);break}case"Z":t.push({key:"Z",data:[]}),r=i,a=l}e=o}return t}function nt(s,t,e){return[s*Math.cos(e)-t*Math.sin(e),s*Math.sin(e)+t*Math.cos(e)]}function pe(s,t,e,r,a,i,l,n,c,o){let h=(f=l,Math.PI*f/180);var f;let p=[],u=0,g=0,d=0,b=0;if(o)[u,g,d,b]=o;else{[s,t]=nt(s,t,-h),[e,r]=nt(e,r,-h);let G=(s-e)/2,R=(t-r)/2,Z=G*G/(a*a)+R*R/(i*i);Z>1&&(Z=Math.sqrt(Z),a*=Z,i*=Z);let K=a*a,tt=i*i,Ee=K*tt-K*R*R-tt*G*G,Be=K*R*R+tt*G*G,qt=(n===c?-1:1)*Math.sqrt(Math.abs(Ee/Be));d=qt*a*R/i+(s+e)/2,b=qt*-i*G/a+(t+r)/2,u=Math.asin(parseFloat(((t-b)/i).toFixed(9))),g=Math.asin(parseFloat(((r-b)/i).toFixed(9))),s<d&&(u=Math.PI-u),e<d&&(g=Math.PI-g),u<0&&(u=2*Math.PI+u),g<0&&(g=2*Math.PI+g),c&&u>g&&(u-=2*Math.PI),!c&&g>u&&(g-=2*Math.PI)}let y=g-u;if(Math.abs(y)>120*Math.PI/180){let G=g,R=e,Z=r;g=c&&g>u?u+120*Math.PI/180*1:u+120*Math.PI/180*-1,p=pe(e=d+a*Math.cos(g),r=b+i*Math.sin(g),R,Z,a,i,l,0,c,[g,G,d,b])}y=g-u;let m=Math.cos(u),w=Math.sin(u),S=Math.cos(g),C=Math.sin(g),M=Math.tan(y/4),L=4/3*a*M,$=4/3*i*M,T=[s,t],O=[s+L*w,t-$*m],I=[e+L*C,r-$*S],J=[e,r];if(O[0]=2*T[0]-O[0],O[1]=2*T[1]-O[1],o)return[O,I,J].concat(p);{p=[O,I,J].concat(p);let G=[];for(let R=0;R<p.length;R+=3){let Z=nt(p[R][0],p[R][1],h),K=nt(p[R+1][0],p[R+1][1],h),tt=nt(p[R+2][0],p[R+2][1],h);G.push([Z[0],Z[1],K[0],K[1],tt[0],tt[1]])}return G}}var Ie={randOffset:function(s,t){return k(s,t)},randOffsetWithRange:function(s,t,e){return wt(s,t,e)},ellipse:function(s,t,e,r,a){let i=ge(e,r,a);return jt(s,t,a,i).opset},doubleLineOps:function(s,t,e,r,a){return F(s,t,e,r,a,!0)}};function ue(s,t,e,r,a){return{type:"path",ops:F(s,t,e,r,a)}}function mt(s,t,e){let r=(s||[]).length;if(r>2){let a=[];for(let i=0;i<r-1;i++)a.push(...F(s[i][0],s[i][1],s[i+1][0],s[i+1][1],e));return t&&a.push(...F(s[r-1][0],s[r-1][1],s[0][0],s[0][1],e)),{type:"path",ops:a}}return r===2?ue(s[0][0],s[0][1],s[1][0],s[1][1],e):{type:"path",ops:[]}}function Ae(s,t,e,r,a){return function(i,l){return mt(i,!0,l)}([[s,t],[s+e,t],[s+e,t+r],[s,t+r]],a)}function ae(s,t){if(s.length){let e=typeof s[0][0]=="number"?[s]:s,r=yt(e[0],1*(1+.2*t.roughness),t),a=t.disableMultiStroke?[]:yt(e[0],1.5*(1+.22*t.roughness),ie(t));for(let i=1;i<e.length;i++){let l=e[i];if(l.length){let n=yt(l,1*(1+.2*t.roughness),t),c=t.disableMultiStroke?[]:yt(l,1.5*(1+.22*t.roughness),ie(t));for(let o of n)o.op!=="move"&&r.push(o);for(let o of c)o.op!=="move"&&a.push(o)}}return{type:"path",ops:r.concat(a)}}return{type:"path",ops:[]}}function ge(s,t,e){let r=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(s/2,2)+Math.pow(t/2,2))/2)),a=Math.ceil(Math.max(e.curveStepCount,e.curveStepCount/Math.sqrt(200)*r)),i=2*Math.PI/a,l=Math.abs(s/2),n=Math.abs(t/2),c=1-e.curveFitting;return l+=k(l*c,e),n+=k(n*c,e),{increment:i,rx:l,ry:n}}function jt(s,t,e,r){let[a,i]=le(r.increment,s,t,r.rx,r.ry,1,r.increment*wt(.1,wt(.4,1,e),e),e),l=kt(a,null,e);if(!e.disableMultiStroke&&e.roughness!==0){let[n]=le(r.increment,s,t,r.rx,r.ry,1.5,0,e),c=kt(n,null,e);l=l.concat(c)}return{estimatedPoints:i,opset:{type:"path",ops:l}}}function se(s,t,e,r,a,i,l,n,c){let o=s,h=t,f=Math.abs(e/2),p=Math.abs(r/2);f+=k(.01*f,c),p+=k(.01*p,c);let u=a,g=i;for(;u<0;)u+=2*Math.PI,g+=2*Math.PI;g-u>2*Math.PI&&(u=0,g=2*Math.PI);let d=2*Math.PI/c.curveStepCount,b=Math.min(d/2,(g-u)/2),y=ce(b,o,h,f,p,u,g,1,c);if(!c.disableMultiStroke){let m=ce(b,o,h,f,p,u,g,1.5,c);y.push(...m)}return l&&(n?y.push(...F(o,h,o+f*Math.cos(u),h+p*Math.sin(u),c),...F(o,h,o+f*Math.cos(g),h+p*Math.sin(g),c)):y.push({op:"lineTo",data:[o,h]},{op:"lineTo",data:[o+f*Math.cos(u),h+p*Math.sin(u)]})),{type:"path",ops:y}}function ne(s,t){let e=fe(he(Gt(s))),r=[],a=[0,0],i=[0,0];for(let{key:l,data:n}of e)switch(l){case"M":i=[n[0],n[1]],a=[n[0],n[1]];break;case"L":r.push(...F(i[0],i[1],n[0],n[1],t)),i=[n[0],n[1]];break;case"C":{let[c,o,h,f,p,u]=n;r.push(...je(c,o,h,f,p,u,i,t)),i=[p,u];break}case"Z":r.push(...F(i[0],i[1],a[0],a[1],t)),i=[a[0],a[1]]}return{type:"path",ops:r}}function Ot(s,t){let e=[];for(let r of s)if(r.length){let a=t.maxRandomnessOffset||0,i=r.length;if(i>2){e.push({op:"move",data:[r[0][0]+k(a,t),r[0][1]+k(a,t)]});for(let l=1;l<i;l++)e.push({op:"lineTo",data:[r[l][0]+k(a,t),r[l][1]+k(a,t)]})}}return{type:"fillPath",ops:e}}function rt(s,t){return function(e,r){let a=e.fillStyle||"hachure";if(!z[a])switch(a){case"zigzag":z[a]||(z[a]=new Bt(r));break;case"cross-hatch":z[a]||(z[a]=new Rt(r));break;case"dots":z[a]||(z[a]=new Nt(r));break;case"dashed":z[a]||(z[a]=new Wt(r));break;case"zigzag-line":z[a]||(z[a]=new It(r));break;default:a="hachure",z[a]||(z[a]=new lt(r))}return z[a]}(t,Ie).fillPolygons(s,t)}function ie(s){let t=Object.assign({},s);return t.randomizer=void 0,s.seed&&(t.seed=s.seed+1),t}function de(s){return s.randomizer||(s.randomizer=new At(s.seed||0)),s.randomizer.next()}function wt(s,t,e,r=1){return e.roughness*r*(de(e)*(t-s)+s)}function k(s,t,e=1){return wt(-s,s,t,e)}function F(s,t,e,r,a,i=!1){let l=i?a.disableMultiStrokeFill:a.disableMultiStroke,n=Ht(s,t,e,r,a,!0,!1);if(l)return n;let c=Ht(s,t,e,r,a,!0,!0);return n.concat(c)}function Ht(s,t,e,r,a,i,l){let n=Math.pow(s-e,2)+Math.pow(t-r,2),c=Math.sqrt(n),o=1;o=c<200?1:c>500?.4:-.0016668*c+1.233334;let h=a.maxRandomnessOffset||0;h*h*100>n&&(h=c/10);let f=h/2,p=.2+.2*de(a),u=a.bowing*a.maxRandomnessOffset*(r-t)/200,g=a.bowing*a.maxRandomnessOffset*(s-e)/200;u=k(u,a,o),g=k(g,a,o);let d=[],b=()=>k(f,a,o),y=()=>k(h,a,o),m=a.preserveVertices;return i&&(l?d.push({op:"move",data:[s+(m?0:b()),t+(m?0:b())]}):d.push({op:"move",data:[s+(m?0:k(h,a,o)),t+(m?0:k(h,a,o))]})),l?d.push({op:"bcurveTo",data:[u+s+(e-s)*p+b(),g+t+(r-t)*p+b(),u+s+2*(e-s)*p+b(),g+t+2*(r-t)*p+b(),e+(m?0:b()),r+(m?0:b())]}):d.push({op:"bcurveTo",data:[u+s+(e-s)*p+y(),g+t+(r-t)*p+y(),u+s+2*(e-s)*p+y(),g+t+2*(r-t)*p+y(),e+(m?0:y()),r+(m?0:y())]}),d}function yt(s,t,e){if(!s.length)return[];let r=[];r.push([s[0][0]+k(t,e),s[0][1]+k(t,e)]),r.push([s[0][0]+k(t,e),s[0][1]+k(t,e)]);for(let a=1;a<s.length;a++)r.push([s[a][0]+k(t,e),s[a][1]+k(t,e)]),a===s.length-1&&r.push([s[a][0]+k(t,e),s[a][1]+k(t,e)]);return kt(r,null,e)}function kt(s,t,e){let r=s.length,a=[];if(r>3){let i=[],l=1-e.curveTightness;a.push({op:"move",data:[s[1][0],s[1][1]]});for(let n=1;n+2<r;n++){let c=s[n];i[0]=[c[0],c[1]],i[1]=[c[0]+(l*s[n+1][0]-l*s[n-1][0])/6,c[1]+(l*s[n+1][1]-l*s[n-1][1])/6],i[2]=[s[n+1][0]+(l*s[n][0]-l*s[n+2][0])/6,s[n+1][1]+(l*s[n][1]-l*s[n+2][1])/6],i[3]=[s[n+1][0],s[n+1][1]],a.push({op:"bcurveTo",data:[i[1][0],i[1][1],i[2][0],i[2][1],i[3][0],i[3][1]]})}if(t&&t.length===2){let n=e.maxRandomnessOffset;a.push({op:"lineTo",data:[t[0]+k(n,e),t[1]+k(n,e)]})}}else r===3?(a.push({op:"move",data:[s[1][0],s[1][1]]}),a.push({op:"bcurveTo",data:[s[1][0],s[1][1],s[2][0],s[2][1],s[2][0],s[2][1]]})):r===2&&a.push(...Ht(s[0][0],s[0][1],s[1][0],s[1][1],e,!0,!0));return a}function le(s,t,e,r,a,i,l,n){let c=[],o=[];if(n.roughness===0){s/=4,o.push([t+r*Math.cos(-s),e+a*Math.sin(-s)]);for(let h=0;h<=2*Math.PI;h+=s){let f=[t+r*Math.cos(h),e+a*Math.sin(h)];c.push(f),o.push(f)}o.push([t+r*Math.cos(0),e+a*Math.sin(0)]),o.push([t+r*Math.cos(s),e+a*Math.sin(s)])}else{let h=k(.5,n)-Math.PI/2;o.push([k(i,n)+t+.9*r*Math.cos(h-s),k(i,n)+e+.9*a*Math.sin(h-s)]);let f=2*Math.PI+h-.01;for(let p=h;p<f;p+=s){let u=[k(i,n)+t+r*Math.cos(p),k(i,n)+e+a*Math.sin(p)];c.push(u),o.push(u)}o.push([k(i,n)+t+r*Math.cos(h+2*Math.PI+.5*l),k(i,n)+e+a*Math.sin(h+2*Math.PI+.5*l)]),o.push([k(i,n)+t+.98*r*Math.cos(h+l),k(i,n)+e+.98*a*Math.sin(h+l)]),o.push([k(i,n)+t+.9*r*Math.cos(h+.5*l),k(i,n)+e+.9*a*Math.sin(h+.5*l)])}return[o,c]}function ce(s,t,e,r,a,i,l,n,c){let o=i+k(.1,c),h=[];h.push([k(n,c)+t+.9*r*Math.cos(o-s),k(n,c)+e+.9*a*Math.sin(o-s)]);for(let f=o;f<=l;f+=s)h.push([k(n,c)+t+r*Math.cos(f),k(n,c)+e+a*Math.sin(f)]);return h.push([t+r*Math.cos(l),e+a*Math.sin(l)]),h.push([t+r*Math.cos(l),e+a*Math.sin(l)]),kt(h,null,c)}function je(s,t,e,r,a,i,l,n){let c=[],o=[n.maxRandomnessOffset||1,(n.maxRandomnessOffset||1)+.3],h=[0,0],f=n.disableMultiStroke?1:2,p=n.preserveVertices;for(let u=0;u<f;u++)u===0?c.push({op:"move",data:[l[0],l[1]]}):c.push({op:"move",data:[l[0]+(p?0:k(o[0],n)),l[1]+(p?0:k(o[0],n))]}),h=p?[a,i]:[a+k(o[u],n),i+k(o[u],n)],c.push({op:"bcurveTo",data:[s+k(o[u],n),t+k(o[u],n),e+k(o[u],n),r+k(o[u],n),h[0],h[1]]});return c}function it(s){return[...s]}function oe(s,t=0){let e=s.length;if(e<3)throw new Error("A curve must have at least three points.");let r=[];if(e===3)r.push(it(s[0]),it(s[1]),it(s[2]),it(s[2]));else{let a=[];a.push(s[0],s[0]);for(let n=1;n<s.length;n++)a.push(s[n]),n===s.length-1&&a.push(s[n]);let i=[],l=1-t;r.push(it(a[0]));for(let n=1;n+2<a.length;n++){let c=a[n];i[0]=[c[0],c[1]],i[1]=[c[0]+(l*a[n+1][0]-l*a[n-1][0])/6,c[1]+(l*a[n+1][1]-l*a[n-1][1])/6],i[2]=[a[n+1][0]+(l*a[n][0]-l*a[n+2][0])/6,a[n+1][1]+(l*a[n][1]-l*a[n+2][1])/6],i[3]=[a[n+1][0],a[n+1][1]],r.push(i[1],i[2],i[3])}}return r}function xt(s,t){return Math.pow(s[0]-t[0],2)+Math.pow(s[1]-t[1],2)}function He(s,t,e){let r=xt(t,e);if(r===0)return xt(s,t);let a=((s[0]-t[0])*(e[0]-t[0])+(s[1]-t[1])*(e[1]-t[1]))/r;return a=Math.max(0,Math.min(1,a)),xt(s,U(t,e,a))}function U(s,t,e){return[s[0]+(t[0]-s[0])*e,s[1]+(t[1]-s[1])*e]}function zt(s,t,e,r){let a=r||[];if(function(n,c){let o=n[c+0],h=n[c+1],f=n[c+2],p=n[c+3],u=3*h[0]-2*o[0]-p[0];u*=u;let g=3*h[1]-2*o[1]-p[1];g*=g;let d=3*f[0]-2*p[0]-o[0];d*=d;let b=3*f[1]-2*p[1]-o[1];return b*=b,u<d&&(u=d),g<b&&(g=b),u+g}(s,t)<e){let n=s[t+0];a.length?(i=a[a.length-1],l=n,Math.sqrt(xt(i,l))>1&&a.push(n)):a.push(n),a.push(s[t+3])}else{let c=s[t+0],o=s[t+1],h=s[t+2],f=s[t+3],p=U(c,o,.5),u=U(o,h,.5),g=U(h,f,.5),d=U(p,u,.5),b=U(u,g,.5),y=U(d,b,.5);zt([c,p,d,y],0,e,a),zt([y,b,g,f],0,e,a)}var i,l;return a}function ze(s,t){return vt(s,0,s.length,t)}function vt(s,t,e,r,a){let i=a||[],l=s[t],n=s[e-1],c=0,o=1;for(let h=t+1;h<e-1;++h){let f=He(s[h],l,n);f>c&&(c=f,o=h)}return Math.sqrt(c)>r?(vt(s,t,o+1,r,i),vt(s,o,e,r,i)):(i.length||i.push(l),i.push(n)),i}function Et(s,t=.15,e){let r=[],a=(s.length-1)/3;for(let i=0;i<a;i++)zt(s,3*i,t,r);return e&&e>0?vt(r,0,r.length,e):r}var X="none",at=class{constructor(t){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=t||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_d(t,e,r){return{shape:t,sets:e||[],options:r||this.defaultOptions}}line(t,e,r,a,i){let l=this._o(i);return this._d("line",[ue(t,e,r,a,l)],l)}rectangle(t,e,r,a,i){let l=this._o(i),n=[],c=Ae(t,e,r,a,l);if(l.fill){let o=[[t,e],[t+r,e],[t+r,e+a],[t,e+a]];l.fillStyle==="solid"?n.push(Ot([o],l)):n.push(rt([o],l))}return l.stroke!==X&&n.push(c),this._d("rectangle",n,l)}ellipse(t,e,r,a,i){let l=this._o(i),n=[],c=ge(r,a,l),o=jt(t,e,l,c);if(l.fill)if(l.fillStyle==="solid"){let h=jt(t,e,l,c).opset;h.type="fillPath",n.push(h)}else n.push(rt([o.estimatedPoints],l));return l.stroke!==X&&n.push(o.opset),this._d("ellipse",n,l)}circle(t,e,r,a){let i=this.ellipse(t,e,r,r,a);return i.shape="circle",i}linearPath(t,e){let r=this._o(e);return this._d("linearPath",[mt(t,!1,r)],r)}arc(t,e,r,a,i,l,n=!1,c){let o=this._o(c),h=[],f=se(t,e,r,a,i,l,n,!0,o);if(n&&o.fill)if(o.fillStyle==="solid"){let p=Object.assign({},o);p.disableMultiStroke=!0;let u=se(t,e,r,a,i,l,!0,!1,p);u.type="fillPath",h.push(u)}else h.push(function(p,u,g,d,b,y,m){let w=p,S=u,C=Math.abs(g/2),M=Math.abs(d/2);C+=k(.01*C,m),M+=k(.01*M,m);let L=b,$=y;for(;L<0;)L+=2*Math.PI,$+=2*Math.PI;$-L>2*Math.PI&&(L=0,$=2*Math.PI);let T=($-L)/m.curveStepCount,O=[];for(let I=L;I<=$;I+=T)O.push([w+C*Math.cos(I),S+M*Math.sin(I)]);return O.push([w+C*Math.cos($),S+M*Math.sin($)]),O.push([w,S]),rt([O],m)}(t,e,r,a,i,l,o));return o.stroke!==X&&h.push(f),this._d("arc",h,o)}curve(t,e){let r=this._o(e),a=[],i=ae(t,r);if(r.fill&&r.fill!==X)if(r.fillStyle==="solid"){let l=ae(t,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));a.push({type:"fillPath",ops:this._mergedShape(l.ops)})}else{let l=[],n=t;if(n.length){let c=typeof n[0][0]=="number"?[n]:n;for(let o of c)o.length<3?l.push(...o):o.length===3?l.push(...Et(oe([o[0],o[0],o[1],o[2]]),10,(1+r.roughness)/2)):l.push(...Et(oe(o),10,(1+r.roughness)/2))}l.length&&a.push(rt([l],r))}return r.stroke!==X&&a.push(i),this._d("curve",a,r)}polygon(t,e){let r=this._o(e),a=[],i=mt(t,!0,r);return r.fill&&(r.fillStyle==="solid"?a.push(Ot([t],r)):a.push(rt([t],r))),r.stroke!==X&&a.push(i),this._d("polygon",a,r)}path(t,e){let r=this._o(e),a=[];if(!t)return this._d("path",a,r);t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");let i=r.fill&&r.fill!=="transparent"&&r.fill!==X,l=r.stroke!==X,n=!!(r.simplification&&r.simplification<1),c=function(h,f,p){let u=fe(he(Gt(h))),g=[],d=[],b=[0,0],y=[],m=()=>{y.length>=4&&d.push(...Et(y,f)),y=[]},w=()=>{m(),d.length&&(g.push(d),d=[])};for(let{key:C,data:M}of u)switch(C){case"M":w(),b=[M[0],M[1]],d.push(b);break;case"L":m(),d.push([M[0],M[1]]);break;case"C":if(!y.length){let L=d.length?d[d.length-1]:b;y.push([L[0],L[1]])}y.push([M[0],M[1]]),y.push([M[2],M[3]]),y.push([M[4],M[5]]);break;case"Z":m(),d.push([b[0],b[1]])}if(w(),!p)return g;let S=[];for(let C of g){let M=ze(C,p);M.length&&S.push(M)}return S}(t,1,n?4-4*(r.simplification||1):(1+r.roughness)/2),o=ne(t,r);if(i)if(r.fillStyle==="solid")if(c.length===1){let h=ne(t,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));a.push({type:"fillPath",ops:this._mergedShape(h.ops)})}else a.push(Ot(c,r));else a.push(rt(c,r));return l&&(n?c.forEach(h=>{a.push(mt(h,!1,r))}):a.push(o)),this._d("path",a,r)}opsToPath(t,e){let r="";for(let a of t.ops){let i=typeof e=="number"&&e>=0?a.data.map(l=>+l.toFixed(e)):a.data;switch(a.op){case"move":r+=`M${i[0]} ${i[1]} `;break;case"bcurveTo":r+=`C${i[0]} ${i[1]}, ${i[2]} ${i[3]}, ${i[4]} ${i[5]} `;break;case"lineTo":r+=`L${i[0]} ${i[1]} `}}return r.trim()}toPaths(t){let e=t.sets||[],r=t.options||this.defaultOptions,a=[];for(let i of e){let l=null;switch(i.type){case"path":l={d:this.opsToPath(i),stroke:r.stroke,strokeWidth:r.strokeWidth,fill:X};break;case"fillPath":l={d:this.opsToPath(i),stroke:X,strokeWidth:0,fill:r.fill||X};break;case"fillSketch":l=this.fillSketch(i,r)}l&&a.push(l)}return a}fillSketch(t,e){let r=e.fillWeight;return r<0&&(r=e.strokeWidth/2),{d:this.opsToPath(t),stroke:e.fill||X,strokeWidth:r,fill:X}}_mergedShape(t){return t.filter((e,r)=>r===0||e.op!=="move")}},Xt=class{constructor(t,e){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.gen=new at(e)}draw(t){let e=t.sets||[],r=t.options||this.getDefaultOptions(),a=this.ctx,i=t.options.fixedDecimalPlaceDigits;for(let l of e)switch(l.type){case"path":a.save(),a.strokeStyle=r.stroke==="none"?"transparent":r.stroke,a.lineWidth=r.strokeWidth,r.strokeLineDash&&a.setLineDash(r.strokeLineDash),r.strokeLineDashOffset&&(a.lineDashOffset=r.strokeLineDashOffset),this._drawToContext(a,l,i),a.restore();break;case"fillPath":{a.save(),a.fillStyle=r.fill||"";let n=t.shape==="curve"||t.shape==="polygon"||t.shape==="path"?"evenodd":"nonzero";this._drawToContext(a,l,i,n),a.restore();break}case"fillSketch":this.fillSketch(a,l,r)}}fillSketch(t,e,r){let a=r.fillWeight;a<0&&(a=r.strokeWidth/2),t.save(),r.fillLineDash&&t.setLineDash(r.fillLineDash),r.fillLineDashOffset&&(t.lineDashOffset=r.fillLineDashOffset),t.strokeStyle=r.fill||"",t.lineWidth=a,this._drawToContext(t,e,r.fixedDecimalPlaceDigits),t.restore()}_drawToContext(t,e,r,a="nonzero"){t.beginPath();for(let i of e.ops){let l=typeof r=="number"&&r>=0?i.data.map(n=>+n.toFixed(r)):i.data;switch(i.op){case"move":t.moveTo(l[0],l[1]);break;case"bcurveTo":t.bezierCurveTo(l[0],l[1],l[2],l[3],l[4],l[5]);break;case"lineTo":t.lineTo(l[0],l[1])}}e.type==="fillPath"?t.fill(a):t.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(t,e,r,a,i){let l=this.gen.line(t,e,r,a,i);return this.draw(l),l}rectangle(t,e,r,a,i){let l=this.gen.rectangle(t,e,r,a,i);return this.draw(l),l}ellipse(t,e,r,a,i){let l=this.gen.ellipse(t,e,r,a,i);return this.draw(l),l}circle(t,e,r,a){let i=this.gen.circle(t,e,r,a);return this.draw(i),i}linearPath(t,e){let r=this.gen.linearPath(t,e);return this.draw(r),r}polygon(t,e){let r=this.gen.polygon(t,e);return this.draw(r),r}arc(t,e,r,a,i,l,n=!1,c){let o=this.gen.arc(t,e,r,a,i,l,n,c);return this.draw(o),o}curve(t,e){let r=this.gen.curve(t,e);return this.draw(r),r}path(t,e){let r=this.gen.path(t,e);return this.draw(r),r}},bt="http://www.w3.org/2000/svg",Yt=class{constructor(t,e){this.svg=t,this.gen=new at(e)}draw(t){let e=t.sets||[],r=t.options||this.getDefaultOptions(),a=this.svg.ownerDocument||window.document,i=a.createElementNS(bt,"g"),l=t.options.fixedDecimalPlaceDigits;for(let n of e){let c=null;switch(n.type){case"path":c=a.createElementNS(bt,"path"),c.setAttribute("d",this.opsToPath(n,l)),c.setAttribute("stroke",r.stroke),c.setAttribute("stroke-width",r.strokeWidth+""),c.setAttribute("fill","none"),r.strokeLineDash&&c.setAttribute("stroke-dasharray",r.strokeLineDash.join(" ").trim()),r.strokeLineDashOffset&&c.setAttribute("stroke-dashoffset",`${r.strokeLineDashOffset}`);break;case"fillPath":c=a.createElementNS(bt,"path"),c.setAttribute("d",this.opsToPath(n,l)),c.setAttribute("stroke","none"),c.setAttribute("stroke-width","0"),c.setAttribute("fill",r.fill||""),t.shape!=="curve"&&t.shape!=="polygon"||c.setAttribute("fill-rule","evenodd");break;case"fillSketch":c=this.fillSketch(a,n,r)}c&&i.appendChild(c)}return i}fillSketch(t,e,r){let a=r.fillWeight;a<0&&(a=r.strokeWidth/2);let i=t.createElementNS(bt,"path");return i.setAttribute("d",this.opsToPath(e,r.fixedDecimalPlaceDigits)),i.setAttribute("stroke",r.fill||""),i.setAttribute("stroke-width",a+""),i.setAttribute("fill","none"),r.fillLineDash&&i.setAttribute("stroke-dasharray",r.fillLineDash.join(" ").trim()),r.fillLineDashOffset&&i.setAttribute("stroke-dashoffset",`${r.fillLineDashOffset}`),i}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(t,e){return this.gen.opsToPath(t,e)}line(t,e,r,a,i){let l=this.gen.line(t,e,r,a,i);return this.draw(l)}rectangle(t,e,r,a,i){let l=this.gen.rectangle(t,e,r,a,i);return this.draw(l)}ellipse(t,e,r,a,i){let l=this.gen.ellipse(t,e,r,a,i);return this.draw(l)}circle(t,e,r,a){let i=this.gen.circle(t,e,r,a);return this.draw(i)}linearPath(t,e){let r=this.gen.linearPath(t,e);return this.draw(r)}polygon(t,e){let r=this.gen.polygon(t,e);return this.draw(r)}arc(t,e,r,a,i,l,n=!1,c){let o=this.gen.arc(t,e,r,a,i,l,n,c);return this.draw(o)}curve(t,e){let r=this.gen.curve(t,e);return this.draw(r)}path(t,e){let r=this.gen.path(t,e);return this.draw(r)}},v={canvas:(s,t)=>new Xt(s,t),svg:(s,t)=>new Yt(s,t),generator:s=>new at(s),newSeed:()=>at.newSeed()};var Xe=x((s,t)=>{var e=s.x,r=s.y,a=t.x-e,i=t.y-r,l=s.width/2,n=s.height/2,c,o;return Math.abs(i)*l>Math.abs(a)*n?(i<0&&(n=-n),c=i===0?0:n*a/i,o=n):(a<0&&(l=-l),c=l,o=a===0?0:l*i/a),{x:e+c,y:r+o}},"intersectRect"),pt=Xe;function ke(s,t){t&&s.attr("style",t)}x(ke,"applyStyle");function ve(s){return D(this,null,function*(){let t=j(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")),e=t.append("xhtml:div"),r=s.label;s.label&&Ut(s.label)&&(r=yield Qt(s.label.replace(Jt.lineBreakRegex,`
`),_()));let a=s.isNode?"nodeLabel":"edgeLabel";return e.html('<span class="'+a+'" '+(s.labelStyle?'style="'+s.labelStyle+'"':"")+">"+r+"</span>"),ke(e,s.labelStyle),e.style("display","inline-block"),e.style("padding-right","1px"),e.style("white-space","nowrap"),e.attr("xmlns","http://www.w3.org/1999/xhtml"),t.node()})}x(ve,"addHtmlLabel");var Ye=x((s,t,e,r)=>D(void 0,null,function*(){let a=s||"";if(typeof a=="object"&&(a=a[0]),V(_().flowchart.htmlLabels)){a=a.replace(/\\n|\n/g,"<br />"),P.info("vertexText"+a);let i={isNode:r,label:Ct(a).replace(/fa[blrs]?:fa-[\w-]+/g,n=>`<i class='${n.replace(":"," ")}'></i>`),labelStyle:t&&t.replace("fill:","color:")};return yield ve(i)}else{let i=document.createElementNS("http://www.w3.org/2000/svg","text");i.setAttribute("style",t.replace("color:","fill:"));let l=[];typeof a=="string"?l=a.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(a)?l=a:l=[];for(let n of l){let c=document.createElementNS("http://www.w3.org/2000/svg","tspan");c.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),c.setAttribute("dy","1em"),c.setAttribute("x","0"),e?c.setAttribute("class","title-row"):c.setAttribute("class","row"),c.textContent=n.trim(),i.appendChild(c)}return i}}),"createLabel"),Q=Ye,ut=x((s,t,e,r,a)=>["M",s+a,t,"H",s+e-a,"A",a,a,0,0,1,s+e,t+a,"V",t+r-a,"A",a,a,0,0,1,s+e-a,t+r,"H",s+a,"A",a,a,0,0,1,s,t+r-a,"V",t+a,"A",a,a,0,0,1,s+a,t,"Z"].join(" "),"createRoundedRectPathD"),ft=x(s=>{let{handDrawnSeed:t}=_();return{fill:s,hachureAngle:120,hachureGap:4,fillWeight:2,roughness:.7,stroke:s,seed:t}},"solidStateFill"),Me=x(s=>{let t=Ge([...s.cssCompiledStyles||[],...s.cssStyles||[]]);return{stylesMap:t,stylesArray:[...t]}},"compileStyles"),Ge=x(s=>{let t=new Map;return s.forEach(e=>{let[r,a]=e.split(":");t.set(r.trim(),a?.trim())}),t},"styles2Map"),A=x(s=>{let{stylesArray:t}=Me(s),e=[],r=[],a=[],i=[];return t.forEach(l=>{let n=l[0];n==="color"||n==="font-size"||n==="font-family"||n==="font-weight"||n==="font-style"||n==="text-decoration"||n==="text-align"||n==="text-transform"||n==="line-height"||n==="letter-spacing"||n==="word-spacing"||n==="text-shadow"||n==="text-overflow"||n==="white-space"||n==="word-wrap"||n==="word-break"||n==="overflow-wrap"||n==="hyphens"?e.push(l.join(":")+" !important"):(r.push(l.join(":")+" !important"),n.includes("stroke")&&a.push(l.join(":")+" !important"),n==="fill"&&i.push(l.join(":")+" !important"))}),{labelStyles:e.join(";"),nodeStyles:r.join(";"),stylesArray:t,borderStyles:a,backgroundStyles:i}},"styles2String"),W=x((s,t)=>{let{themeVariables:e,handDrawnSeed:r}=_(),{nodeBorder:a,mainBkg:i}=e,{stylesMap:l}=Me(s);return Object.assign({roughness:.7,fill:l.get("fill")||i,fillStyle:"hachure",fillWeight:4,stroke:l.get("stroke")||a,seed:r,strokeWidth:1.3},t)},"userNodeOverrides"),Se=x((s,t)=>D(void 0,null,function*(){P.info("Creating subgraph rect for ",t.id,t);let e=_(),{themeVariables:r,handDrawnSeed:a}=e,{clusterBkg:i,clusterBorder:l}=r,{labelStyles:n,nodeStyles:c,borderStyles:o,backgroundStyles:h}=A(t),f=s.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),p=V(e.flowchart.htmlLabels),u=f.insert("g").attr("class","cluster-label "),g=yield gt(u,t.label,{style:t.labelStyle,useHtmlLabels:p,isNode:!0}),d=g.getBBox();if(V(e.flowchart.htmlLabels)){let L=g.children[0],$=j(g);d=L.getBoundingClientRect(),$.attr("width",d.width),$.attr("height",d.height)}let b=t.width<=d.width+t.padding?d.width+t.padding:t.width;t.width<=d.width+t.padding?t.diff=(b-t.width)/2-t.padding:t.diff=-t.padding;let y=t.height,m=t.x-b/2,w=t.y-y/2;P.trace("Data ",t,JSON.stringify(t));let S;if(t.look==="handDrawn"){let L=v.svg(f),$=W(t,{roughness:.7,fill:i,stroke:l,fillWeight:3,seed:a}),T=L.path(ut(m,w,b,y,0),$);S=f.insert(()=>(P.debug("Rough node insert CXC",T),T),":first-child"),S.select("path:nth-child(2)").attr("style",o.join(";")),S.select("path").attr("style",h.join(";").replace("fill","stroke"))}else S=f.insert("rect",":first-child"),S.attr("style",c).attr("rx",t.rx).attr("ry",t.ry).attr("x",m).attr("y",w).attr("width",b).attr("height",y);let{subGraphTitleTopMargin:C}=Pt(e);if(u.attr("transform",`translate(${t.x-d.width/2}, ${t.y-t.height/2+C})`),n){let L=u.select("span");L&&L.attr("style",n)}let M=S.node().getBBox();return t.offsetX=0,t.width=M.width,t.height=M.height,t.offsetY=d.height-t.padding/2,t.intersect=function(L){return pt(t,L)},{cluster:f,labelBBox:d}}),"rect"),Ze=x((s,t)=>{let e=s.insert("g").attr("class","note-cluster").attr("id",t.id),r=e.insert("rect",":first-child"),a=0*t.padding,i=a/2;r.attr("rx",t.rx).attr("ry",t.ry).attr("x",t.x-t.width/2-i).attr("y",t.y-t.height/2-i).attr("width",t.width+a).attr("height",t.height+a).attr("fill","none");let l=r.node().getBBox();return t.width=l.width,t.height=l.height,t.intersect=function(n){return pt(t,n)},{cluster:e,labelBBox:{width:0,height:0}}},"noteGroup"),Ve=x((s,t)=>D(void 0,null,function*(){let e=_(),{themeVariables:r,handDrawnSeed:a}=e,{altBackground:i,compositeBackground:l,compositeTitleBackground:n,nodeBorder:c}=r,o=s.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-id",t.id).attr("data-look",t.look),h=o.insert("g",":first-child"),f=o.insert("g").attr("class","cluster-label"),p=o.append("rect"),u=f.node().appendChild(yield Q(t.label,t.labelStyle,void 0,!0)),g=u.getBBox();if(V(e.flowchart.htmlLabels)){let T=u.children[0],O=j(u);g=T.getBoundingClientRect(),O.attr("width",g.width),O.attr("height",g.height)}let d=0*t.padding,b=d/2,y=(t.width<=g.width+t.padding?g.width+t.padding:t.width)+d;t.width<=g.width+t.padding?t.diff=(y-t.width)/2-t.padding:t.diff=-t.padding;let m=t.height+d,w=t.height+d-g.height-6,S=t.x-y/2,C=t.y-m/2;t.width=y;let M=t.y-t.height/2-b+g.height+2,L;if(t.look==="handDrawn"){let T=t.cssClasses.includes("statediagram-cluster-alt"),O=v.svg(o),I=t.rx||t.ry?O.path(ut(S,C,y,m,10),{roughness:.7,fill:n,fillStyle:"solid",stroke:c,seed:a}):O.rectangle(S,C,y,m,{seed:a});L=o.insert(()=>I,":first-child");let J=O.rectangle(S,M,y,w,{fill:T?i:l,fillStyle:T?"hachure":"solid",stroke:c,seed:a});L=o.insert(()=>I,":first-child"),p=o.insert(()=>J)}else L=h.insert("rect",":first-child"),L.attr("class","outer").attr("x",S).attr("y",C).attr("width",y).attr("height",m).attr("data-look",t.look),p.attr("class","inner").attr("x",S).attr("y",M).attr("width",y).attr("height",w);f.attr("transform",`translate(${t.x-g.width/2}, ${C+1-(V(e.flowchart.htmlLabels)?0:3)})`);let $=L.node().getBBox();return t.height=$.height,t.offsetX=0,t.offsetY=g.height-t.padding/2,t.labelBBox=g,t.intersect=function(T){return pt(t,T)},{cluster:o,labelBBox:g}}),"roundedWithTitle"),qe=x((s,t)=>{let e=_(),{themeVariables:r,handDrawnSeed:a}=e,{nodeBorder:i}=r,l=s.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-look",t.look),n=l.insert("g",":first-child"),c=0*t.padding,o=t.width+c;t.diff=-t.padding;let h=t.height+c,f=t.x-o/2,p=t.y-h/2;t.width=o;let u;if(t.look==="handDrawn"){let b=v.svg(l).rectangle(f,p,o,h,{fill:"lightgrey",roughness:.5,strokeLineDash:[5],stroke:i,seed:a});u=l.insert(()=>b,":first-child")}else u=n.insert("rect",":first-child"),u.attr("class","divider").attr("x",f).attr("y",p).attr("width",o).attr("height",h).attr("data-look",t.look);let g=u.node().getBBox();return t.height=g.height,t.offsetX=0,t.offsetY=0,t.intersect=function(d){return pt(t,d)},{cluster:l,labelBBox:{}}},"divider"),Fe=Se,Ue={rect:Se,squareRect:Fe,roundedWithTitle:Ve,noteGroup:Ze,divider:qe},Le=new Map,ra=x((s,t)=>D(void 0,null,function*(){let e=t.shape||"rect",r=yield Ue[e](s,t);return Le.set(t.id,r),r}),"insertCluster"),aa=x(()=>{Le=new Map},"clear"),Qe=x((s,t,e,r,a)=>{t.arrowTypeStart&&ye(s,"start",t.arrowTypeStart,e,r,a),t.arrowTypeEnd&&ye(s,"end",t.arrowTypeEnd,e,r,a)},"addEdgeMarkers"),Je={arrow_cross:"cross",arrow_point:"point",arrow_barb:"barb",arrow_circle:"circle",aggregation:"aggregation",extension:"extension",composition:"composition",dependency:"dependency",lollipop:"lollipop"},ye=x((s,t,e,r,a,i)=>{let l=Je[e];if(!l){P.warn(`Unknown arrow type: ${e}`);return}let n=t==="start"?"Start":"End";s.attr(`marker-${t}`,`url(${r}#${a}_${i}-${l}${n})`)},"addEdgeMarker"),St=new Map,N=new Map,ia=x(()=>{St.clear(),N.clear()},"clear"),ot=x(s=>s?s.reduce((e,r)=>e+";"+r,""):"","getLabelStyles"),la=x((s,t)=>D(void 0,null,function*(){let e=V(_().flowchart.htmlLabels),r=yield gt(s,t.label,{style:ot(t.labelStyle),useHtmlLabels:e,addSvgBackground:!0,isNode:!1});P.info("abc82",t,t.labelType);let a=s.insert("g").attr("class","edgeLabel"),i=a.insert("g").attr("class","label");i.node().appendChild(r);let l=r.getBBox();if(e){let c=r.children[0],o=j(r);l=c.getBoundingClientRect(),o.attr("width",l.width),o.attr("height",l.height)}i.attr("transform","translate("+-l.width/2+", "+-l.height/2+")"),St.set(t.id,a),t.width=l.width,t.height=l.height;let n;if(t.startLabelLeft){let c=yield Q(t.startLabelLeft,ot(t.labelStyle)),o=s.insert("g").attr("class","edgeTerminals"),h=o.insert("g").attr("class","inner");n=h.node().appendChild(c);let f=c.getBBox();h.attr("transform","translate("+-f.width/2+", "+-f.height/2+")"),N.get(t.id)||N.set(t.id,{}),N.get(t.id).startLeft=o,ht(n,t.startLabelLeft)}if(t.startLabelRight){let c=yield Q(t.startLabelRight,ot(t.labelStyle)),o=s.insert("g").attr("class","edgeTerminals"),h=o.insert("g").attr("class","inner");n=o.node().appendChild(c),h.node().appendChild(c);let f=c.getBBox();h.attr("transform","translate("+-f.width/2+", "+-f.height/2+")"),N.get(t.id)||N.set(t.id,{}),N.get(t.id).startRight=o,ht(n,t.startLabelRight)}if(t.endLabelLeft){let c=yield Q(t.endLabelLeft,ot(t.labelStyle)),o=s.insert("g").attr("class","edgeTerminals"),h=o.insert("g").attr("class","inner");n=h.node().appendChild(c);let f=c.getBBox();h.attr("transform","translate("+-f.width/2+", "+-f.height/2+")"),o.node().appendChild(c),N.get(t.id)||N.set(t.id,{}),N.get(t.id).endLeft=o,ht(n,t.endLabelLeft)}if(t.endLabelRight){let c=yield Q(t.endLabelRight,ot(t.labelStyle)),o=s.insert("g").attr("class","edgeTerminals"),h=o.insert("g").attr("class","inner");n=h.node().appendChild(c);let f=c.getBBox();h.attr("transform","translate("+-f.width/2+", "+-f.height/2+")"),o.node().appendChild(c),N.get(t.id)||N.set(t.id,{}),N.get(t.id).endRight=o,ht(n,t.endLabelRight)}return r}),"insertEdgeLabel");function ht(s,t){_().flowchart.htmlLabels&&s&&(s.style.width=t.length*9+"px",s.style.height="12px")}x(ht,"setTerminalWidth");var ca=x((s,t)=>{P.debug("Moving label abc88 ",s.id,s.label,St.get(s.id),t);let e=t.updatedPath?t.updatedPath:t.originalPath,r=_(),{subGraphTitleTotalMargin:a}=Pt(r);if(s.label){let i=St.get(s.id),l=s.x,n=s.y;if(e){let c=et.calcLabelPosition(e);P.debug("Moving label "+s.label+" from (",l,",",n,") to (",c.x,",",c.y,") abc88"),t.updatedPath&&(l=c.x,n=c.y)}i.attr("transform",`translate(${l}, ${n+a/2})`)}if(s.startLabelLeft){let i=N.get(s.id).startLeft,l=s.x,n=s.y;if(e){let c=et.calcTerminalLabelPosition(s.arrowTypeStart?10:0,"start_left",e);l=c.x,n=c.y}i.attr("transform",`translate(${l}, ${n})`)}if(s.startLabelRight){let i=N.get(s.id).startRight,l=s.x,n=s.y;if(e){let c=et.calcTerminalLabelPosition(s.arrowTypeStart?10:0,"start_right",e);l=c.x,n=c.y}i.attr("transform",`translate(${l}, ${n})`)}if(s.endLabelLeft){let i=N.get(s.id).endLeft,l=s.x,n=s.y;if(e){let c=et.calcTerminalLabelPosition(s.arrowTypeEnd?10:0,"end_left",e);l=c.x,n=c.y}i.attr("transform",`translate(${l}, ${n})`)}if(s.endLabelRight){let i=N.get(s.id).endRight,l=s.x,n=s.y;if(e){let c=et.calcTerminalLabelPosition(s.arrowTypeEnd?10:0,"end_right",e);l=c.x,n=c.y}i.attr("transform",`translate(${l}, ${n})`)}},"positionEdgeLabel"),Ke=x((s,t)=>{let e=s.x,r=s.y,a=Math.abs(t.x-e),i=Math.abs(t.y-r),l=s.width/2,n=s.height/2;return a>=l||i>=n},"outsideNode"),tr=x((s,t,e)=>{P.debug(`intersection calc abc89:
  outsidePoint: ${JSON.stringify(t)}
  insidePoint : ${JSON.stringify(e)}
  node        : x:${s.x} y:${s.y} w:${s.width} h:${s.height}`);let r=s.x,a=s.y,i=Math.abs(r-e.x),l=s.width/2,n=e.x<t.x?l-i:l+i,c=s.height/2,o=Math.abs(t.y-e.y),h=Math.abs(t.x-e.x);if(Math.abs(a-t.y)*l>Math.abs(r-t.x)*c){let f=e.y<t.y?t.y-c-a:a-c-t.y;n=h*f/o;let p={x:e.x<t.x?e.x+n:e.x-h+n,y:e.y<t.y?e.y+o-f:e.y-o+f};return n===0&&(p.x=t.x,p.y=t.y),h===0&&(p.x=t.x),o===0&&(p.y=t.y),P.debug(`abc89 top/bottom calc, Q ${o}, q ${f}, R ${h}, r ${n}`,p),p}else{e.x<t.x?n=t.x-l-r:n=r-l-t.x;let f=o*n/h,p=e.x<t.x?e.x+h-n:e.x-h+n,u=e.y<t.y?e.y+f:e.y-f;return P.debug(`sides calc abc89, Q ${o}, q ${f}, R ${h}, r ${n}`,{_x:p,_y:u}),n===0&&(p=t.x,u=t.y),h===0&&(p=t.x),o===0&&(u=t.y),{x:p,y:u}}},"intersection"),be=x((s,t)=>{P.warn("abc88 cutPathAtIntersect",s,t);let e=[],r=s[0],a=!1;return s.forEach(i=>{if(P.info("abc88 checking point",i,t),!Ke(t,i)&&!a){let l=tr(t,r,i);P.debug("abc88 inside",i,r,l),P.debug("abc88 intersection",l,t);let n=!1;e.forEach(c=>{n=n||c.x===l.x&&c.y===l.y}),e.some(c=>c.x===l.x&&c.y===l.y)?P.warn("abc88 no intersect",l,e):e.push(l),a=!0}else P.warn("abc88 outside",i,r),r=i,a||e.push(i)}),P.debug("returning points",e),e},"cutPathAtIntersect");function $e(s){let t=[],e=[];for(let r=1;r<s.length-1;r++){let a=s[r-1],i=s[r],l=s[r+1];(a.x===i.x&&i.y===l.y&&Math.abs(i.x-l.x)>5&&Math.abs(i.y-a.y)>5||a.y===i.y&&i.x===l.x&&Math.abs(i.x-a.x)>5&&Math.abs(i.y-l.y)>5)&&(t.push(i),e.push(r))}return{cornerPoints:t,cornerPointPositions:e}}x($e,"extractCornerPoints");var me=x(function(s,t,e){let r=t.x-s.x,a=t.y-s.y,i=Math.sqrt(r*r+a*a),l=e/i;return{x:t.x-l*r,y:t.y-l*a}},"findAdjacentPoint"),er=x(function(s){let{cornerPointPositions:t}=$e(s),e=[];for(let r=0;r<s.length;r++)if(t.includes(r)){let a=s[r-1],i=s[r+1],l=s[r],n=me(a,l,5),c=me(i,l,5),o=c.x-n.x,h=c.y-n.y;e.push(n);let f=Math.sqrt(2)*2,p={x:l.x,y:l.y};if(Math.abs(i.x-a.x)>10&&Math.abs(i.y-a.y)>=10){P.debug("Corner point fixing",Math.abs(i.x-a.x),Math.abs(i.y-a.y));let u=5;l.x===n.x?p={x:o<0?n.x-u+f:n.x+u-f,y:h<0?n.y-f:n.y+f}:p={x:o<0?n.x-f:n.x+f,y:h<0?n.y-u+f:n.y+u-f}}else P.debug("Corner point skipping fixing",Math.abs(i.x-a.x),Math.abs(i.y-a.y));e.push(p,c)}else e.push(s[r]);return e},"fixCorners"),oa=x(function(s,t,e,r,a,i,l){let{handDrawnSeed:n}=_(),c=t.points,o=!1,h=a;var f=i;f.intersect&&h.intersect&&(c=c.slice(1,t.points.length-1),c.unshift(h.intersect(c[0])),P.debug("Last point APA12",t.start,"-->",t.end,c[c.length-1],f,f.intersect(c[c.length-1])),c.push(f.intersect(c[c.length-1]))),t.toCluster&&(P.info("to cluster abc88",e.get(t.toCluster)),c=be(t.points,e.get(t.toCluster).node),o=!0),t.fromCluster&&(P.debug("from cluster abc88",e.get(t.fromCluster),JSON.stringify(c,null,2)),c=be(c.reverse(),e.get(t.fromCluster).node).reverse(),o=!0);let p=c.filter($=>!Number.isNaN($.y));p=er(p);let u=p[p.length-1];if(p.length>1){u=p[p.length-1];let $=p[p.length-2],T=(u.x-$.x)/2,O=(u.y-$.y)/2,I={x:$.x+T,y:$.y+O};p.splice(-1,0,I)}let g=ee;t.curve&&(g=t.curve);let{x:d,y:b}=Kt(t),y=te().x(d).y(b).curve(g),m;switch(t.thickness){case"normal":m="edge-thickness-normal";break;case"thick":m="edge-thickness-thick";break;case"invisible":m="edge-thickness-invisible";break;default:m="edge-thickness-normal"}switch(t.pattern){case"solid":m+=" edge-pattern-solid";break;case"dotted":m+=" edge-pattern-dotted";break;case"dashed":m+=" edge-pattern-dashed";break;default:m+=" edge-pattern-solid"}let w,S=y(p),C=Array.isArray(t.style)?t.style:[t.style];if(t.look==="handDrawn"){let $=v.svg(s);Object.assign([],p);let T=$.path(S,{roughness:.3,seed:n});m+=" transition",w=j(T).select("path").attr("id",t.id).attr("class"," "+m+(t.classes?" "+t.classes:"")).attr("style",C?C.reduce((I,J)=>I+";"+J,""):"");let O=w.attr("d");w.attr("d",O),s.node().appendChild(w.node())}else w=s.append("path").attr("d",S).attr("id",t.id).attr("class"," "+m+(t.classes?" "+t.classes:"")).attr("style",C?C.reduce(($,T)=>$+";"+T,""):"");let M="";(_().flowchart.arrowMarkerAbsolute||_().state.arrowMarkerAbsolute)&&(M=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,M=M.replace(/\(/g,"\\(").replace(/\)/g,"\\)")),P.info("arrowTypeStart",t.arrowTypeStart),P.info("arrowTypeEnd",t.arrowTypeEnd),Qe(w,t,M,l,r);let L={};return o&&(L.updatedPath=c),L.originalPath=t.points,L},"insertEdge"),rr=x((s,t,e,r)=>{t.forEach(a=>{pr[a](s,e,r)})},"insertMarkers"),ar=x((s,t,e)=>{P.trace("Making markers for ",e),s.append("defs").append("marker").attr("id",e+"_"+t+"-extensionStart").attr("class","marker extension "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 1,7 L18,13 V 1 Z"),s.append("defs").append("marker").attr("id",e+"_"+t+"-extensionEnd").attr("class","marker extension "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 1,1 V 13 L18,7 Z")},"extension"),sr=x((s,t,e)=>{s.append("defs").append("marker").attr("id",e+"_"+t+"-compositionStart").attr("class","marker composition "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),s.append("defs").append("marker").attr("id",e+"_"+t+"-compositionEnd").attr("class","marker composition "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"composition"),nr=x((s,t,e)=>{s.append("defs").append("marker").attr("id",e+"_"+t+"-aggregationStart").attr("class","marker aggregation "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),s.append("defs").append("marker").attr("id",e+"_"+t+"-aggregationEnd").attr("class","marker aggregation "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"aggregation"),ir=x((s,t,e)=>{s.append("defs").append("marker").attr("id",e+"_"+t+"-dependencyStart").attr("class","marker dependency "+t).attr("refX",6).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 5,7 L9,13 L1,7 L9,1 Z"),s.append("defs").append("marker").attr("id",e+"_"+t+"-dependencyEnd").attr("class","marker dependency "+t).attr("refX",13).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L14,7 L9,1 Z")},"dependency"),lr=x((s,t,e)=>{s.append("defs").append("marker").attr("id",e+"_"+t+"-lollipopStart").attr("class","marker lollipop "+t).attr("refX",13).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6),s.append("defs").append("marker").attr("id",e+"_"+t+"-lollipopEnd").attr("class","marker lollipop "+t).attr("refX",1).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6)},"lollipop"),cr=x((s,t,e)=>{s.append("marker").attr("id",e+"_"+t+"-pointEnd").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),s.append("marker").attr("id",e+"_"+t+"-pointStart").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",4.5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("path").attr("d","M 0 5 L 10 10 L 10 0 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"point"),or=x((s,t,e)=>{s.append("marker").attr("id",e+"_"+t+"-circleEnd").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",11).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),s.append("marker").attr("id",e+"_"+t+"-circleStart").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",-1).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"circle"),hr=x((s,t,e)=>{s.append("marker").attr("id",e+"_"+t+"-crossEnd").attr("class","marker cross "+t).attr("viewBox","0 0 11 11").attr("refX",12).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0"),s.append("marker").attr("id",e+"_"+t+"-crossStart").attr("class","marker cross "+t).attr("viewBox","0 0 11 11").attr("refX",-1).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0")},"cross"),fr=x((s,t,e)=>{s.append("defs").append("marker").attr("id",e+"_"+t+"-barbEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",14).attr("markerUnits","userSpaceOnUse").attr("orient","auto").append("path").attr("d","M 19,7 L9,13 L14,7 L9,1 Z")},"barb"),pr={extension:ar,composition:sr,aggregation:nr,dependency:ir,lollipop:lr,point:cr,circle:or,cross:hr,barb:fr},ha=rr,H=x((s,t,e)=>D(void 0,null,function*(){let r,a=t.useHtmlLabels||V(_().flowchart.htmlLabels);e?r=e:r="node default";let i=s.insert("g").attr("class",r).attr("id",t.domId||t.id),l=i.insert("g").attr("class","label").attr("style",t.labelStyle),n;t.label===void 0?n="":n=typeof t.label=="string"?t.label:t.label[0];let c;c=yield gt(l,Ft(Ct(n),_()),{useHtmlLabels:a,width:t.width||_().flowchart.wrappingWidth,cssClasses:"markdown-node-label",style:t.labelStyle});let o=c.getBBox(),h=t.padding/2;if(V(_().flowchart.htmlLabels)){let f=c.children[0],p=j(c),u=f.getElementsByTagName("img");if(u){let g=n.replace(/<img[^>]*>/g,"").trim()==="";yield Promise.all([...u].map(d=>new Promise(b=>{function y(){if(d.style.display="flex",d.style.flexDirection="column",g){let m=_().fontSize?_().fontSize:window.getComputedStyle(document.body).fontSize,S=parseInt(m,10)*5+"px";d.style.minWidth=S,d.style.maxWidth=S}else d.style.width="100%";b(d)}x(y,"setupImage"),setTimeout(()=>{d.complete&&y()}),d.addEventListener("error",y),d.addEventListener("load",y)})))}o=f.getBoundingClientRect(),p.attr("width",o.width),p.attr("height",o.height)}return a?l.attr("transform","translate("+-o.width/2+", "+-o.height/2+")"):l.attr("transform","translate(0, "+-o.height/2+")"),t.centerLabel&&l.attr("transform","translate("+-o.width/2+", "+-o.height/2+")"),l.insert("rect",":first-child"),{shapeSvg:i,bbox:o,halfPadding:h,label:l}}),"labelHelper"),B=x((s,t)=>{let e=t.node().getBBox();s.width=e.width,s.height=e.height},"updateNodeBounds"),Y=x((s,t)=>(s.look==="handDrawn"?"rough-node":"node")+" "+s.cssClasses+" "+(t||""),"getNodeClasses");function Pe(s,t){return s.intersect(t)}x(Pe,"intersectNode");var ur=Pe;function Ce(s,t,e,r){var a=s.x,i=s.y,l=a-r.x,n=i-r.y,c=Math.sqrt(t*t*n*n+e*e*l*l),o=Math.abs(t*e*l/c);r.x<a&&(o=-o);var h=Math.abs(t*e*n/c);return r.y<i&&(h=-h),{x:a+o,y:i+h}}x(Ce,"intersectEllipse");var De=Ce;function Te(s,t,e){return De(s,t,t,e)}x(Te,"intersectCircle");var gr=Te;function _e(s,t,e,r){var a,i,l,n,c,o,h,f,p,u,g,d,b,y,m;if(a=t.y-s.y,l=s.x-t.x,c=t.x*s.y-s.x*t.y,p=a*e.x+l*e.y+c,u=a*r.x+l*r.y+c,!(p!==0&&u!==0&&Zt(p,u))&&(i=r.y-e.y,n=e.x-r.x,o=r.x*e.y-e.x*r.y,h=i*s.x+n*s.y+o,f=i*t.x+n*t.y+o,!(h!==0&&f!==0&&Zt(h,f))&&(g=a*n-i*l,g!==0)))return d=Math.abs(g/2),b=l*o-n*c,y=b<0?(b-d)/g:(b+d)/g,b=i*c-a*o,m=b<0?(b-d)/g:(b+d)/g,{x:y,y:m}}x(_e,"intersectLine");function Zt(s,t){return s*t>0}x(Zt,"sameSign");var dr=_e;function Oe(s,t,e){let r=s.x,a=s.y,i=[],l=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY;typeof t.forEach=="function"?t.forEach(function(h){l=Math.min(l,h.x),n=Math.min(n,h.y)}):(l=Math.min(l,t.x),n=Math.min(n,t.y));let c=r-s.width/2-l,o=a-s.height/2-n;for(let h=0;h<t.length;h++){let f=t[h],p=t[h<t.length-1?h+1:0],u=dr(s,e,{x:c+f.x,y:o+f.y},{x:c+p.x,y:o+p.y});u&&i.push(u)}return i.length?(i.length>1&&i.sort(function(h,f){let p=h.x-e.x,u=h.y-e.y,g=Math.sqrt(p*p+u*u),d=f.x-e.x,b=f.y-e.y,y=Math.sqrt(d*d+b*b);return g<y?-1:g===y?0:1}),i[0]):s}x(Oe,"intersectPolygon");var yr=Oe,E={node:ur,circle:gr,ellipse:De,polygon:yr,rect:pt},Vt=x((s,t,e)=>D(void 0,null,function*(){let{labelStyles:r,nodeStyles:a}=A(t);t.labelStyle=r;let{shapeSvg:i,bbox:l}=yield H(s,t,Y(t)),n=Math.max(l.width+e.labelPaddingX*2,t?.width||0),c=Math.max(l.height+e.labelPaddingY*2,t?.height||0),o=-n/2,h=-c/2,f,{rx:p,ry:u}=t,{cssStyles:g}=t;if(e?.rx&&e.ry&&(p=e.rx,u=e.ry),t.look==="handDrawn"){let d=v.svg(i),b=W(t,{}),y=p||u?d.path(ut(o,h,n,c,p||0),b):d.rectangle(o,h,n,c,b);f=i.insert(()=>y,":first-child"),f.attr("class","basic label-container").attr("style",g)}else f=i.insert("rect",":first-child"),f.attr("class","basic label-container").attr("style",a).attr("rx",p).attr("data-id","abc").attr("data-et","node").attr("ry",u).attr("x",o).attr("y",h).attr("width",n).attr("height",c);return B(t,f),t.intersect=function(d){return E.rect(t,d)},i}),"drawRect"),br=x((s,t)=>D(void 0,null,function*(){return Vt(s,t,{rx:5,ry:5,classes:"flowchart-node"})}),"state"),mr=x((s,t)=>D(void 0,null,function*(){let e={rx:5,ry:5,classes:"",labelPaddingX:(t?.padding||0)*1,labelPaddingY:(t?.padding||0)*1};return Vt(s,t,e)}),"roundedRect"),xr=x((s,t)=>D(void 0,null,function*(){let e={rx:0,ry:0,classes:"",labelPaddingX:(t?.padding||0)*2,labelPaddingY:(t?.padding||0)*1};return Vt(s,t,e)}),"squareRect"),wr=x((s,t)=>{let{themeVariables:e}=_(),{lineColor:r}=e,a=s.insert("g").attr("class","node default").attr("id",t.domId||t.id),i;if(t.look==="handDrawn"){let n=v.svg(a).circle(0,0,14,ft(r));i=a.insert(()=>n)}else i=a.insert("circle",":first-child");return i.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14),B(t,i),t.intersect=function(l){return E.circle(t,7,l)},a},"stateStart"),kr=x((s,t)=>{let{themeVariables:e}=_(),{lineColor:r}=e,a=s.insert("g").attr("class","node default").attr("id",t.domId||t.id),i,l;if(t.look==="handDrawn"){let n=v.svg(a),c=n.circle(0,0,14,$t(Lt({},ft(r)),{roughness:.5})),o=n.circle(0,0,5,$t(Lt({},ft(r)),{fillStyle:"solid"}));i=a.insert(()=>c),l=a.insert(()=>o)}else l=a.insert("circle",":first-child"),i=a.insert("circle",":first-child"),i.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14),l.attr("class","state-end").attr("r",5).attr("width",10).attr("height",10);return B(t,i),t.intersect=function(n){return E.circle(t,7,n)},a},"stateEnd"),xe=x((s,t,e)=>{let{themeVariables:r}=_(),{lineColor:a}=r,i=s.insert("g").attr("class","node default").attr("id",t.domId||t.id),l=70,n=10;e==="LR"&&(l=10,n=70);let c=-1*l/2,o=-1*n/2,h;if(t.look==="handDrawn"){let d=v.svg(i).rectangle(c,o,l,n,ft(a));h=i.insert(()=>d)}else h=i.append("rect").attr("x",c).attr("y",o).attr("width",l).attr("height",n).attr("class","fork-join");B(t,h);let f=0,p=0,u=10;return t.height&&(f=t.height),t.width&&(p=t.width),t.padding&&(u=t.padding),t.height=f+u/2,t.width=p+u/2,t.intersect=function(g){return E.rect(t,g)},i},"forkJoin"),vr=x((s,t)=>{let{labelStyles:e,nodeStyles:r}=A(t);t.labelStyle=e;let{themeVariables:a}=_(),{lineColor:i}=a,l=s.insert("g").attr("class","node default").attr("id",t.domId||t.id),n=28,c=[{x:0,y:n/2},{x:n/2,y:0},{x:0,y:-n/2},{x:-n/2,y:0}],o;if(t.look==="handDrawn"){let h=v.svg(l),f=c.map(function(u){return[u.x,u.y]}),p=h.polygon(f,ft(i));o=l.insert(()=>p)}else o=l.insert("polygon",":first-child").attr("points",c.map(function(h){return h.x+","+h.y}).join(" "));return o.attr("class","state-start").attr("r",7).attr("width",28).attr("height",28).attr("style",r),t.width=28,t.height=28,t.intersect=function(h){return E.circle(t,14,h)},l},"choice"),Mr=x((s,t)=>D(void 0,null,function*(){let{themeVariables:e,handDrawnSeed:r}=_(),{noteBorderColor:a,noteBkgColor:i}=e;t.useHtmlLabels||(t.centerLabel=!0);let{shapeSvg:n,bbox:c}=yield H(s,t,"node "+t.cssClasses);P.info("Classes = ",t.cssClasses);let{cssStyles:o}=t,h,f=c.width+t.padding,p=c.height+t.padding,u=-f/2,g=-p/2;if(t.look==="handDrawn"){let b=v.svg(n).rectangle(u,g,f,p,{roughness:.7,fill:i,fillWeight:3,seed:r,stroke:a});h=n.insert(()=>b,":first-child"),h.attr("class","basic label-container").attr("style",o)}else h=n.insert("rect",":first-child"),h.attr("rx",t.rx).attr("ry",t.ry).attr("x",u).attr("y",g).attr("width",f).attr("height",p);return B(t,h),t.intersect=function(d){return E.rect(t,d)},n}),"note"),Sr=x((s,t)=>D(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=A(t);t.labelStyle=e;let{shapeSvg:a,bbox:i}=yield H(s,t,Y(t)),l=i.height+t.padding,n=i.width+l/4+t.padding,c,{cssStyles:o}=t;if(t.look==="handDrawn"){let h=v.svg(a),f=W(t,{}),p=ut(-n/2,-l/2,n,l,l/2),u=h.path(p,f);c=a.insert(()=>u,":first-child"),c.attr("class","basic label-container").attr("style",o)}else c=a.insert("rect",":first-child"),c.attr("class","basic label-container").attr("style",r).attr("rx",l/2).attr("ry",l/2).attr("x",-n/2).attr("y",-l/2).attr("width",n).attr("height",l);return B(t,c),t.intersect=function(h){return E.rect(t,h)},a}),"stadium"),Lr=x((s,t)=>D(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=A(t);t.labelStyle=e;let a;t.cssClasses?a="node "+t.cssClasses:a="node default";let i=s.insert("g").attr("class",a).attr("id",t.domId||t.id),l=i.insert("g"),n=i.insert("g").attr("class","label").attr("style",r),c=t.description,o=t.label,h=n.node().appendChild(yield Q(o,t.labelStyle,!0,!0)),f={width:0,height:0};if(V(_()?.flowchart?.htmlLabels)){let $=h.children[0],T=j(h);f=$.getBoundingClientRect(),T.attr("width",f.width),T.attr("height",f.height)}P.info("Text 2",c);let p=c||[],u=h.getBBox(),g=n.node().appendChild(yield Q(p.join?p.join("<br/>"):p,t.labelStyle,!0,!0)),d=g.children[0],b=j(g);f=d.getBoundingClientRect(),b.attr("width",f.width),b.attr("height",f.height);let y=(t.padding||0)/2;j(g).attr("transform","translate( "+(f.width>u.width?0:(u.width-f.width)/2)+", "+(u.height+y+5)+")"),j(h).attr("transform","translate( "+(f.width<u.width?0:-(u.width-f.width)/2)+", 0)"),f=n.node().getBBox(),n.attr("transform","translate("+-f.width/2+", "+(-f.height/2-y+3)+")");let m=f.width+(t.padding||0),w=f.height+(t.padding||0),S=-f.width/2-y,C=-f.height/2-y,M,L;if(t.look==="handDrawn"){let $=v.svg(i),T=W(t,{}),O=$.path(ut(S,C,m,w,t.rx||0),T),I=$.line(-f.width/2-y,-f.height/2-y+u.height+y,f.width/2+y,-f.height/2-y+u.height+y,T);L=i.insert(()=>(P.debug("Rough node insert CXC",O),I),":first-child"),M=i.insert(()=>(P.debug("Rough node insert CXC",O),O),":first-child")}else M=l.insert("rect",":first-child"),L=l.insert("line"),M.attr("class","outer title-state").attr("style",r).attr("x",-f.width/2-y).attr("y",-f.height/2-y).attr("width",f.width+(t.padding||0)).attr("height",f.height+(t.padding||0)),L.attr("class","divider").attr("x1",-f.width/2-y).attr("x2",f.width/2+y).attr("y1",-f.height/2-y+u.height+y).attr("y2",-f.height/2-y+u.height+y);return B(t,M),t.intersect=function($){return E.rect(t,$)},i}),"rectWithTitle");function q(s,t,e,r){return s.insert("polygon",":first-child").attr("points",r.map(function(a){return a.x+","+a.y}).join(" ")).attr("class","label-container").attr("transform","translate("+-t/2+","+e/2+")")}x(q,"insertPolygonShape");var $r=x((s,t)=>D(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=A(t);t.labelStyle=e;let{shapeSvg:a,bbox:i}=yield H(s,t,Y(t)),l=(t?.padding||0)/2,n=i.width+t.padding,c=i.height+t.padding,o=-i.width/2-l,h=-i.height/2-l,f=[{x:0,y:0},{x:n,y:0},{x:n,y:-c},{x:0,y:-c},{x:0,y:0},{x:-8,y:0},{x:n+8,y:0},{x:n+8,y:-c},{x:-8,y:-c},{x:-8,y:0}];if(t.look==="handDrawn"){let p=v.svg(a),u=W(t,{}),g=p.rectangle(o-8,h,n+16,c,u),d=p.line(o,h,o,h+c,u),b=p.line(o+n,h,o+n,h+c,u);a.insert(()=>d,":first-child"),a.insert(()=>b,":first-child");let y=a.insert(()=>g,":first-child"),{cssStyles:m}=t;y.attr("class","basic label-container").attr("style",m),B(t,y)}else{let p=q(a,n,c,f);r&&p.attr("style",r),B(t,p)}return t.intersect=function(p){return E.polygon(t,f,p)},a}),"subroutine"),Pr=x((s,t,e,r,a,i)=>[`M${s},${t+i}`,`a${a},${i} 0,0,0 ${e},0`,`a${a},${i} 0,0,0 ${-e},0`,`l0,${r}`,`a${a},${i} 0,0,0 ${e},0`,`l0,${-r}`].join(" "),"createCylinderPathD"),Cr=x((s,t,e,r,a,i)=>[`M${s},${t+i}`,`M${s+e},${t+i}`,`a${a},${i} 0,0,0 ${-e},0`,`l0,${r}`,`a${a},${i} 0,0,0 ${e},0`,`l0,${-r}`].join(" "),"createOuterCylinderPathD"),Dr=x((s,t,e,r,a,i)=>[`M${s-e/2},${-r/2}`,`a${a},${i} 0,0,0 ${e},0`].join(" "),"createInnerCylinderPathD"),Tr=x((s,t)=>D(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=A(t);t.labelStyle=e;let{shapeSvg:a,bbox:i}=yield H(s,t,Y(t)),l=i.width+t.padding,n=l/2,c=n/(2.5+l/50),o=i.height+c+t.padding,h,{cssStyles:f}=t;if(t.look==="handDrawn"){let p=v.svg(a),u=Cr(0,0,l,o,n,c),g=Dr(0,c,l,o,n,c),d=p.path(u,W(t,{})),b=p.path(g,W(t,{fill:"none"}));h=a.insert(()=>b,":first-child"),h=a.insert(()=>d,":first-child"),h.attr("class","basic label-container"),f&&h.attr("style",f)}else{let p=Pr(0,0,l,o,n,c);h=a.insert("path",":first-child").attr("d",p).attr("class","basic label-container").attr("style",f).attr("style",r)}return h.attr("label-offset-y",c),h.attr("transform",`translate(${-l/2}, ${-(o/2+c)})`),B(t,h),t.intersect=function(p){let u=E.rect(t,p),g=u.x-(t.x??0);if(n!=0&&(Math.abs(g)<(t.width??0)/2||Math.abs(g)==(t.width??0)/2&&Math.abs(u.y-(t.y??0))>(t.height??0)/2-c)){let d=c*c*(1-g*g/(n*n));d>0&&(d=Math.sqrt(d)),d=c-d,p.y-(t.y??0)>0&&(d=-d),u.y+=d}return u},a}),"cylinder"),_r=x((s,t)=>D(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=A(t);t.labelStyle=e;let{shapeSvg:a,bbox:i,halfPadding:l}=yield H(s,t,Y(t)),n=i.width/2+l,c,{cssStyles:o}=t;if(t.look==="handDrawn"){let h=v.svg(a),f=W(t,{}),p=h.circle(0,0,n*2,f);c=a.insert(()=>p,":first-child"),c.attr("class","basic label-container").attr("style",o)}else c=a.insert("circle",":first-child").attr("class","basic label-container").attr("style",r).attr("r",n).attr("cx",0).attr("cy",0);return B(t,c),t.intersect=function(h){return P.info("Circle intersect",t,n,h),E.circle(t,n,h)},a}),"circle"),Or=x((s,t)=>D(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=A(t);t.labelStyle=e;let{shapeSvg:a,bbox:i,halfPadding:l}=yield H(s,t,Y(t)),c=i.width/2+l+5,o=i.width/2+l,h,{cssStyles:f}=t;if(t.look==="handDrawn"){let p=v.svg(a),u=W(t,{roughness:.2,strokeWidth:2.5}),g=W(t,{roughness:.2,strokeWidth:1.5}),d=p.circle(0,0,c*2,u),b=p.circle(0,0,o*2,g);h=a.insert("g",":first-child"),h.attr("class",t.cssClasses).attr("style",f),h.node()?.appendChild(d),h.node()?.appendChild(b)}else{h=a.insert("g",":first-child");let p=h.insert("circle",":first-child"),u=h.insert("circle");h.attr("class","basic label-container").attr("style",r),p.attr("class","outer-circle").attr("style",r).attr("r",c).attr("cx",0).attr("cy",0),u.attr("class","inner-circle").attr("style",r).attr("r",o).attr("cx",0).attr("cy",0)}return B(t,h),t.intersect=function(p){return P.info("DoubleCircle intersect",t,c,p),E.circle(t,c,p)},a}),"doublecircle"),Er=x((s,t,e,r)=>[`M${s-r/2},${t}`,`L${s+e},${t}`,`L${s+e},${t-r}`,`L${s-r/2},${t-r}`,`L${s},${t-r/2}`,"Z"].join(" "),"createPolygonPathD"),Br=x((s,t)=>D(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=A(t);t.labelStyle=e;let{shapeSvg:a,bbox:i}=yield H(s,t,Y(t)),l=i.width+t.padding,n=i.height+t.padding,c=[{x:-n/2,y:0},{x:l,y:0},{x:l,y:-n},{x:-n/2,y:-n},{x:0,y:-n/2}],o,{cssStyles:h}=t;if(t.look==="handDrawn"){let f=v.svg(a),p=W(t,{}),u=Er(0,0,l,n),g=f.path(u,p);o=a.insert(()=>g,":first-child").attr("transform",`translate(${-l/2}, ${n/2})`),h&&o.attr("style",h)}else o=q(a,l,n,c);return r&&o.attr("style",r),t.width=l+n,t.height=n,B(t,o),t.intersect=function(f){return E.polygon(t,c,f)},a}),"rect_left_inv_arrow"),Rr=x((s,t,e)=>[`M${s+e/2},${t}`,`L${s+e},${t-e/2}`,`L${s+e/2},${t-e}`,`L${s},${t-e/2}`,"Z"].join(" "),"createDecisionBoxPathD"),Nr=x((s,t)=>D(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=A(t);t.labelStyle=e;let{shapeSvg:a,bbox:i}=yield H(s,t,Y(t)),l=i.width+t.padding,n=i.height+t.padding,c=l+n,o=[{x:c/2,y:0},{x:c,y:-c/2},{x:c/2,y:-c},{x:0,y:-c/2}],h,{cssStyles:f}=t;if(t.look==="handDrawn"){let p=v.svg(a),u=W(t,{}),g=Rr(0,0,c),d=p.path(g,u);h=a.insert(()=>d,":first-child").attr("transform",`translate(${-c/2}, ${c/2})`),f&&h.attr("style",f)}else h=q(a,c,c,o);return r&&h.attr("style",r),B(t,h),t.intersect=function(p){return P.debug(`APA12 Intersect called SPLIT
point:`,p,`
node:
`,t,`
res:`,E.polygon(t,o,p)),E.polygon(t,o,p)},a}),"question"),Wr=x((s,t,e,r,a)=>[`M${s+a},${t}`,`L${s+e-a},${t}`,`L${s+e},${t-r/2}`,`L${s+e-a},${t-r}`,`L${s+a},${t-r}`,`L${s},${t-r/2}`,"Z"].join(" "),"createHexagonPathD"),Ir=x((s,t)=>D(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=A(t);t.labelStyle=e;let{shapeSvg:a,bbox:i}=yield H(s,t,Y(t)),l=4,n=i.height+t.padding,c=n/l,o=i.width+2*c+t.padding,h=[{x:c,y:0},{x:o-c,y:0},{x:o,y:-n/2},{x:o-c,y:-n},{x:c,y:-n},{x:0,y:-n/2}],f,{cssStyles:p}=t;if(t.look==="handDrawn"){let u=v.svg(a),g=W(t,{}),d=Wr(0,0,o,n,c),b=u.path(d,g);f=a.insert(()=>b,":first-child").attr("transform",`translate(${-o/2}, ${n/2})`),p&&f.attr("style",p)}else f=q(a,o,n,h);return r&&f.attr("style",r),t.width=o,t.height=n,B(t,f),t.intersect=function(u){return E.polygon(t,h,u)},a}),"hexagon"),Ar=x((s,t,e,r)=>[`M${s-2*r/6},${t}`,`L${s+e-r/6},${t}`,`L${s+e+2*r/6},${t-r}`,`L${s+r/6},${t-r}`,"Z"].join(" "),"createLeanRightPathD"),jr=x((s,t)=>D(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=A(t);t.labelStyle=e;let{shapeSvg:a,bbox:i}=yield H(s,t,Y(t)),l=i.width+t.padding,n=i.height+t.padding,c=[{x:-2*n/6,y:0},{x:l-n/6,y:0},{x:l+2*n/6,y:-n},{x:n/6,y:-n}],o,{cssStyles:h}=t;if(t.look==="handDrawn"){let f=v.svg(a),p=W(t,{}),u=Ar(0,0,l,n),g=f.path(u,p);o=a.insert(()=>g,":first-child").attr("transform",`translate(${-l/2}, ${n/2})`),h&&o.attr("style",h)}else o=q(a,l,n,c);return r&&o.attr("style",r),t.width=l,t.height=n,B(t,o),t.intersect=function(f){return E.polygon(t,c,f)},a}),"lean_right"),Hr=x((s,t,e,r)=>[`M${s+2*r/6},${t}`,`L${s+e+r/6},${t}`,`L${s+e-2*r/6},${t-r}`,`L${s-r/6},${t-r}`,"Z"].join(" "),"createLeanLeftPathD"),zr=x((s,t)=>D(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=A(t);t.labelStyle=e;let{shapeSvg:a,bbox:i}=yield H(s,t,Y(t)),l=i.width+t.padding,n=i.height+t.padding,c=[{x:2*n/6,y:0},{x:l+n/6,y:0},{x:l-2*n/6,y:-n},{x:-n/6,y:-n}],o,{cssStyles:h}=t;if(t.look==="handDrawn"){let f=v.svg(a),p=W(t,{}),u=Hr(0,0,l,n),g=f.path(u,p);o=a.insert(()=>g,":first-child").attr("transform",`translate(${-l/2}, ${n/2})`),h&&o.attr("style",h)}else o=q(a,l,n,c);return r&&o.attr("style",r),t.width=l,t.height=n,B(t,o),t.intersect=function(f){return E.polygon(t,c,f)},a}),"lean_left"),Xr=x((s,t,e,r)=>[`M${s-2*r/6},${t}`,`L${s+e+2*r/6},${t}`,`L${s+e-r/6},${t-r}`,`L${s+r/6},${t-r}`,"Z"].join(" "),"createTrapezoidPathD"),Yr=x((s,t)=>D(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=A(t);t.labelStyle=e;let{shapeSvg:a,bbox:i}=yield H(s,t,Y(t)),l=i.width+t.padding,n=i.height+t.padding,c=[{x:-2*n/6,y:0},{x:l+2*n/6,y:0},{x:l-n/6,y:-n},{x:n/6,y:-n}],o,{cssStyles:h}=t;if(t.look==="handDrawn"){let f=v.svg(a),p=W(t,{}),u=Xr(0,0,l,n),g=f.path(u,p);o=a.insert(()=>g,":first-child").attr("transform",`translate(${-l/2}, ${n/2})`),h&&o.attr("style",h)}else o=q(a,l,n,c);return r&&o.attr("style",r),t.width=l,t.height=n,B(t,o),t.intersect=function(f){return E.polygon(t,c,f)},a}),"trapezoid"),Gr=x((s,t,e,r)=>[`M${s+r/6},${t}`,`L${s+e-r/6},${t}`,`L${s+e+2*r/6},${t-r}`,`L${s-2*r/6},${t-r}`,"Z"].join(" "),"createInvertedTrapezoidPathD"),Zr=x((s,t)=>D(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=A(t);t.labelStyle=e;let{shapeSvg:a,bbox:i}=yield H(s,t,Y(t)),l=i.width+t.padding,n=i.height+t.padding,c=[{x:n/6,y:0},{x:l-n/6,y:0},{x:l+2*n/6,y:-n},{x:-2*n/6,y:-n}],o,{cssStyles:h}=t;if(t.look==="handDrawn"){let f=v.svg(a),p=W(t,{}),u=Gr(0,0,l,n),g=f.path(u,p);o=a.insert(()=>g,":first-child").attr("transform",`translate(${-l/2}, ${n/2})`),h&&o.attr("style",h)}else o=q(a,l,n,c);return r&&o.attr("style",r),t.width=l,t.height=n,B(t,o),t.intersect=function(f){return E.polygon(t,c,f)},a}),"inv_trapezoid"),Vr=x((s,t)=>D(void 0,null,function*(){let{shapeSvg:e}=yield H(s,t,"label"),r=e.insert("rect",":first-child");return r.attr("width",.1).attr("height",.1),e.attr("class","label edgeLabel"),B(t,r),t.intersect=function(l){return E.rect(t,l)},e}),"labelRect"),we={state:br,stateStart:wr,stateEnd:kr,fork:xe,join:xe,choice:vr,note:Mr,roundedRect:mr,rectWithTitle:Lr,squareRect:xr,stadium:Sr,subroutine:$r,cylinder:Tr,circle:_r,doublecircle:Or,odd:Br,diamond:Nr,hexagon:Ir,lean_right:jr,lean_left:zr,trapezoid:Yr,inv_trapezoid:Zr,labelRect:Vr},st=new Map,Oa=x((s,t,e)=>D(void 0,null,function*(){let r,a;if(t.shape==="rect"&&(t.rx&&t.ry?t.shape="roundedRect":t.shape="squareRect"),t.link){let i;_().securityLevel==="sandbox"?i="_top":t.linkTarget&&(i=t.linkTarget||"_blank"),r=s.insert("svg:a").attr("xlink:href",t.link).attr("target",i),a=yield we[t.shape](r,t,e)}else a=yield we[t.shape](s,t,e),r=a;return t.tooltip&&a.attr("title",t.tooltip),st.set(t.id,r),t.haveCallback&&st.get(t.id).attr("class",st.get(t.id).attr("class")+" clickable"),r}),"insertNode"),Ea=x((s,t)=>{st.set(t.id,s)},"setNodeElem"),Ba=x(()=>{st.clear()},"clear"),Ra=x(s=>{let t=st.get(s.id);P.trace("Transforming node",s.diff,s,"translate("+(s.x-s.width/2-5)+", "+s.width/2+")");let e=8,r=s.diff||0;return s.clusterNode?t.attr("transform","translate("+(s.x+r-s.width/2)+", "+(s.y-s.height/2-e)+")"):t.attr("transform","translate("+s.x+", "+s.y+")"),r},"positionNode");export{ra as a,aa as b,ia as c,la as d,ca as e,oa as f,ha as g,H as h,B as i,Oa as j,Ea as k,Ba as l,Ra as m};
